"use client";import React, {  createContext,  useContext,  useState,  ReactNode,  useEffect,  useCallback,} from "react";import { userPreferencesApi } from "@/app/lib/api/user-preferences";import { UserPreferences } from "@/app/lib/types/types";interface PaginationContextType {  currentPage: number;  itemsPerPage: number;  setCurrentPage: (page: number) => void;  setItemsPerPage: (items: number) => void;  resetToFirstPage: () => void;   isLoading?: boolean;}const PaginationContext = createContext<PaginationContextType | undefined>(  undefined);export const PaginationProvider: React.FC<{ children: ReactNode }> = ({  children,}) => {  const [isLoading, setIsLoading] = useState(true);  const [currentPage, setCurrentPage] = useState(1);  const [itemsPerPage, setItemsPerPage] = useState(10);  const resetToFirstPage = useCallback(() => {    setCurrentPage(1);  }, []);  const [preferences, setPreferences] = useState<UserPreferences | null>(null);  useEffect(() => {    const loadPreferences = async () => {      setIsLoading(true);      try {        const prefs = await userPreferencesApi.get();        setPreferences(prefs);        if (prefs?.itemsPerPage) {          setItemsPerPage(prefs.itemsPerPage);        }      } catch (error) {        console.error("Error loading user preferences:", error);      } finally {        setIsLoading(false);      }    };    loadPreferences();  }, []);  useEffect(() => {    if (isLoading) return;    const savePreferences = async () => {      try {        await userPreferencesApi.upsert({
          itemsPerPage,
          acceptedTerms: preferences?.acceptedTerms ?? true,
          appVersion: preferences?.appVersion,
        });      } catch (error) {        console.error("Error saving user preferences:", error);      }    };    savePreferences();  }, [itemsPerPage, isLoading, preferences]);  return (    <PaginationContext.Provider      value={{        currentPage,        itemsPerPage,        setCurrentPage,        setItemsPerPage,        resetToFirstPage,        isLoading,      }}    >      {children}    </PaginationContext.Provider>  );};export const usePagination = () => {  const context = useContext(PaginationContext);  if (!context) {    throw new Error("usePagination must be used within a PaginationProvider");  }  return context;};