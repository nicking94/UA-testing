// hooks/useProductsApi.tsimport { useState, useCallback } from 'react';import { productsApi, ProductFilters } from '@/app/lib/api/products';import { Product } from '@/app/lib/types/types';export const useProductsApi = () => {  const [products, setProducts] = useState<Product[]>([]);  const [loading, setLoading] = useState(false);  const [error, setError] = useState<string | null>(null);  const fetchProducts = useCallback(async (filters?: ProductFilters) => {    setLoading(true);    setError(null);    try {      const data = await productsApi.getAll(filters);      const formattedProducts = data.map((p) => ({        ...p,        id: Number(p.id),        customCategories: (p.customCategories || []).filter(          (cat) => cat.name && cat.name.trim()        ),        costPrice: p.costPrice || 0,        price: p.price || 0,        currentPrice: p.currentPrice || p.price || 0,        stock: p.stock || 0,        quantity: p.quantity || 1,        rubro: p.rubro === 'Todos_los_rubros' ? 'Todos los rubros' : p.rubro,      }));      setProducts(formattedProducts);      return formattedProducts;    } catch (err: unknown) {      const errorMessage = (err as Error).message || 'Error al cargar productos';      setError(errorMessage);      console.error('Error fetching products:', err);      throw err;    } finally {      setLoading(false);    }  }, []);  const addProduct = useCallback(async (product: Omit<Product, 'id'>) => {    setLoading(true);    setError(null);    try {      const newProduct = await productsApi.create(product);      const formattedProduct = {        ...newProduct,        id: Number(newProduct.id),        customCategories: newProduct.customCategories || [],      };      setProducts((prev) => [...prev, formattedProduct]);      return formattedProduct;    } catch (err: unknown) {      const errorMessage = (err as Error).message || 'Error al crear producto';      setError(errorMessage);      throw err;    } finally {      setLoading(false);    }  }, []);  const updateProduct = useCallback(    async (id: number, updates: Partial<Product>) => {      setLoading(true);      setError(null);      try {        const updated = await productsApi.update(id, updates);        const formattedProduct = {          ...updated,          id: Number(updated.id),          customCategories: updated.customCategories || [],        };        setProducts((prev) =>          prev.map((p) => (p.id === id ? formattedProduct : p))        );        return formattedProduct;      } catch (err: unknown) {        const errorMessage = (err as Error).message || 'Error al actualizar producto';        setError(errorMessage);        throw err;      } finally {        setLoading(false);      }    },    []  );  const deleteProduct = useCallback(async (id: number) => {    setLoading(true);    setError(null);    try {      await productsApi.delete(id);      setProducts((prev) => prev.filter((p) => p.id !== id));    } catch (err: unknown) {      const errorMessage = (err as Error).message || 'Error al eliminar producto';      setError(errorMessage);      throw err;    } finally {      setLoading(false);    }  }, []);  const getProductByBarcode = useCallback(async (barcode: string) => {    setLoading(true);    setError(null);    try {      const product = await productsApi.getByBarcode(barcode);      return product;    } catch (err: unknown) {      const errorMessage = (err as Error).message || 'Error al buscar producto';      setError(errorMessage);      return null;    } finally {      setLoading(false);    }  }, []);  return {    products,    loading,    error,    fetchProducts,    addProduct,    updateProduct,    deleteProduct,    getProductByBarcode,    setProducts,  };};