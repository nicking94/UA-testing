import { Injectable, UnauthorizedException } from '@nestjs/common';import { JwtService } from '@nestjs/jwt';import { PrismaService } from '../prisma/prisma.service';import * as bcrypt from 'bcrypt';@Injectable()export class AuthService {  constructor(    private prisma: PrismaService,    private jwtService: JwtService,  ) {}  async validateUser(username: string, password: string): Promise<any> {    const user = await this.prisma.user.findUnique({      where: { username },    });    if (user && user.password) {      const isPasswordValid = await bcrypt.compare(password, user.password);      if (isPasswordValid) {        const { password, ...result } = user;        return result;      }    }    return null;  }  async login(user: any) {    const payload = { username: user.username, sub: user.id };    return {      access_token: this.jwtService.sign(payload),      user: {        id: user.id,        username: user.username,        logo: user.logo,        isActive: user.isActive,      },    };  }  async register(username: string, password: string) {    const hashedPassword = await bcrypt.hash(password, 10);    const user = await this.prisma.user.create({      data: {        username,        password: hashedPassword,        isActive: true,      },    });    const { password: _, ...result } = user;    return result;  }}